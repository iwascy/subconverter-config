[general]
emoji = true
resolve_domain = true
prepend_rule = true
enable_rule_generator = true
overwrite_original_rules = true
node_exclude = (?i)剩余|流量|过期|时间|到期|官网|群|频道

[rename_proxy]
; 给中转节点加 TRANSIT- 前缀，但保留原节点名（含地区信息）
(?i)(.*(中转|Transit).*) = TRANSIT-${index}-$1
; 给落地/自建节点加 EXIT- 前缀，同样保留原节点名
(?i)(.*(落地|Exit|自建|daishuge).*) = EXIT-${index}-$1

[custom]
; ------------------------ 自定义规则 (不变) ------------------------
ruleset=iQIYI,clash-domain:https://raw.githubusercontent.com/zsfyi/V2rayDomains2Clash/generated/iqiyi.yaml,86400
ruleset=Bilibili,clash-domain:https://raw.githubusercontent.com/zsfyi/V2rayDomains2Clash/generated/bilibili.yaml,86400
ruleset=Streaming media,clash-domain:https://raw.githubusercontent.com/zsfyi/V2rayDomains2Clash/generated/netflix.yaml,86400
ruleset=Streaming media,clash-domain:https://raw.githubusercontent.com/zsfyi/V2rayDomains2Clash/generated/hulu.yaml,86400
ruleset=Streaming media,clash-domain:https://raw.githubusercontent.com/zsfyi/V2rayDomains2Clash/generated/disney.yaml,86400
ruleset=Streaming media,clash-domain:https://raw.githubusercontent.com/zsfyi/V2rayDomains2Clash/generated/hbo.yaml,86400
ruleset=Streaming media,clash-domain:https://raw.githubusercontent.com/zsfyi/V2rayDomains2Clash/generated/primevideo.yaml,86400
ruleset=Streaming media,clash-domain:https://raw.githubusercontent.com/zsfyi/V2rayDomains2Clash/generated/youtube.yaml,86400
ruleset=Streaming media,clash-domain:https://raw.githubusercontent.com/zsfyi/V2rayDomains2Clash/generated/spotify.yaml,86400
ruleset=Cryptocurrency,clash-domain:https://raw.githubusercontent.com/zsfyi/V2rayDomains2Clash/generated/category-cryptocurrency.yaml,86400
ruleset=PayPal,clash-domain:https://raw.githubusercontent.com/zsfyi/V2rayDomains2Clash/generated/paypal.yaml,86400
ruleset=Stripe,clash-domain:https://raw.githubusercontent.com/zsfyi/V2rayDomains2Clash/generated/stripe.yaml,86400
ruleset=OpenAI,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/OpenAI/OpenAI.yaml,86400
ruleset=Claude,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Claude/Claude.yaml,86400
ruleset=Gemini,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Gemini/Gemini.yaml,86400
ruleset=Grok,https://raw.githubusercontent.com/iwascy/subconverter-config/main/Grok.list
ruleset=Perplexity,https://raw.githubusercontent.com/iwascy/subconverter-config/main/Perplexity.list
ruleset=Games CN,clash-domain:https://raw.githubusercontent.com/zsfyi/V2rayDomains2Clash/generated/category-games@cn.yaml,86400
ruleset=Games,clash-domain:https://raw.githubusercontent.com/zsfyi/V2rayDomains2Clash/generated/category-games.yaml,86400
ruleset=Google FCM,clash-domain:https://raw.githubusercontent.com/zsfyi/V2rayDomains2Clash/generated/googlefcm.yaml,86400
ruleset=OneDrive,clash-domain:https://raw.githubusercontent.com/zsfyi/V2rayDomains2Clash/generated/onedrive.yaml,86400
ruleset=Microsoft CN,clash-domain:https://raw.githubusercontent.com/zsfyi/V2rayDomains2Clash/generated/microsoft@cn.yaml,86400
ruleset=Microsoft,clash-domain:https://raw.githubusercontent.com/zsfyi/V2rayDomains2Clash/generated/microsoft.yaml,86400
ruleset=iCloud CN,clash-domain:https://raw.githubusercontent.com/zsfyi/V2rayDomains2Clash/generated/icloud@cn.yaml,86400
ruleset=iCloud,clash-domain:https://raw.githubusercontent.com/zsfyi/V2rayDomains2Clash/generated/icloud.yaml,86400
ruleset=Apple CN,clash-domain:https://raw.githubusercontent.com/zsfyi/V2rayDomains2Clash/generated/apple@cn.yaml,86400
ruleset=Apple,clash-domain:https://raw.githubusercontent.com/zsfyi/V2rayDomains2Clash/generated/apple.yaml,86400
ruleset=Social Media CN,clash-domain:https://raw.githubusercontent.com/zsfyi/V2rayDomains2Clash/generated/category-social-media-cn.yaml,86400
ruleset=Social Media,clash-domain:https://raw.githubusercontent.com/zsfyi/V2rayDomains2Clash/generated/category-communication.yaml,86400
ruleset=Social Media,clash-domain:https://raw.githubusercontent.com/zsfyi/V2rayDomains2Clash/generated/category-social-media-%21cn.yaml,86400
ruleset=Social Media,clash-domain:https://raw.githubusercontent.com/zsfyi/V2rayDomains2Clash/generated/zoom.yaml,86400
ruleset=Media CN,clash-domain:https://raw.githubusercontent.com/zsfyi/V2rayDomains2Clash/generated/category-media-cn.yaml,86400
ruleset=Media,clash-domain:https://raw.githubusercontent.com/zsfyi/V2rayDomains2Clash/generated/category-media.yaml,86400
ruleset=Media,clash-domain:https://raw.githubusercontent.com/zsfyi/V2rayDomains2Clash/generated/category-forums.yaml,86400
ruleset=Scholar CN,clash-domain:https://raw.githubusercontent.com/zsfyi/V2rayDomains2Clash/generated/category-scholar-cn.yaml,86400
ruleset=Scholar,clash-domain:https://raw.githubusercontent.com/zsfyi/V2rayDomains2Clash/generated/category-scholar-%21cn.yaml,86400
ruleset=Personal,https://raw.githubusercontent.com/iwascy/subconverter-config/main/Personal.list
; 内网与公司网段直连，防止代理影响内网访问
ruleset=Global Direct,[]IP-CIDR,10.12.0.0/24
ruleset=Global Direct,[]IP-CIDR,10.100.0.0/24
ruleset=Global Direct,[]IP-CIDR,10.100.1.0/24
ruleset=Global Direct,[]IP-CIDR,10.0.1.64/32
ruleset=Global Direct,[]IP-CIDR,112.74.102.253/32
ruleset=Global Direct,[]IP-CIDR,47.251.116.83/32
ruleset=Global Direct,[]IP-CIDR,172.16.0.0/12
ruleset=Global Direct,[]IP-CIDR,192.168.0.0/24
ruleset=Global Direct,[]IP-CIDR,192.168.12.244/32
ruleset=Global Direct,[]IP-CIDR,180.184.196.50/32
ruleset=Global Direct,[]GEOIP,LAN
ruleset=CN Direct,[]GEOIP,CN
ruleset=Final,[]FINAL


; --------------------- 核心策略组 (顺序调整，必须最先定义) ---------------------

; -- 基础组件 --
; SELECT 现在是「选分组」，而不是直接选节点
custom_proxy_group=SELECT`select`[]RELAY-CHAIN`[]HK Fallback`[]US Fallback`[]HK`[]TW`[]SG`[]JP`[]US`[]UK`[]BWG`[]AUTO`[]DIRECT

custom_proxy_group=AUTO`url-test`.*`http://www.gstatic.com/generate_204`300,,50
custom_proxy_group=HK`url-test`(香港|港|Hong Kong|HK)`http://www.gstatic.com/generate_204`300,,50
custom_proxy_group=TW`url-test`(台湾|台|Taiwan|TW)`http://www.gstatic.com/generate_204`300,,50
custom_proxy_group=SG`url-test`(新加坡|坡|Singapore|SG)`http://www.gstatic.com/generate_204`300,,50
custom_proxy_group=JP`url-test`(日本|日|Japan|JP)`http://www.gstatic.com/generate_204`300,,50
custom_proxy_group=US`url-test`(美国|美|United States|US)`http://www.gstatic.com/generate_204`300,,50
custom_proxy_group=UK`url-test`(英国|英|United Kingdom|UK)`http://www.gstatic.com/generate_204`300,,50
custom_proxy_group=HK Fallback`fallback`[]HK`[]TW`[]SG`[]JP`[]US`[]UK`http://www.gstatic.com/generate_204`300
custom_proxy_group=US Fallback`fallback`[]US`[]JP`[]SG`[]TW`[]HK`[]UK`http://www.gstatic.com/generate_204`300

; -- BWG 专用分组：匹配节点名包含 bwg/BWG（大小写不敏感）
custom_proxy_group=BWG`select`(?i)bwg

; -- 链式代理核心组件 --
custom_proxy_group=TRANSIT-HK`url-test`(?=.*(香港|港|Hong Kong|HK))(?!.*落地).*`http://www.gstatic.com/generate_204`300,,50
custom_proxy_group=TRANSIT-TW`url-test`(?=.*(台湾|台|Taiwan|TW))(?!.*落地).*`http://www.gstatic.com/generate_204`300,,50
custom_proxy_group=TRANSIT-SG`url-test`(?=.*(新加坡|坡|Singapore|SG))(?!.*落地).*`http://www.gstatic.com/generate_204`300,,50
custom_proxy_group=TRANSIT-JP`url-test`(?=.*(日本|日|Japan|JP))(?!.*落地).*`http://www.gstatic.com/generate_204`300,,50
custom_proxy_group=TRANSIT-US`url-test`(?=.*(美国|美|United States|US))(?!.*落地).*`http://www.gstatic.com/generate_204`300,,50
custom_proxy_group=TRANSIT-UK`url-test`(?=.*(英国|英|United Kingdom|UK))(?!.*落地).*`http://www.gstatic.com/generate_204`300,,50
custom_proxy_group=TRANSIT`select`[]TRANSIT-HK`[]TRANSIT-TW`[]TRANSIT-SG`[]TRANSIT-JP`[]TRANSIT-US`[]TRANSIT-UK

; -- 链式代理组 --
custom_proxy_group=RELAY-CHAIN`relay`[]TRANSIT`[]EXIT

; -- 落地节点组 --
custom_proxy_group=EXIT`select`落地

; --------------------- 应用策略组 (引用核心组) ---------------------
custom_proxy_group=iQIYI`select`[]DIRECT`[]RELAY-CHAIN`[]HK`[]TW`[]SG`[]JP`[]US`[]UK`[]TRANSIT-HK`[]TRANSIT-TW`[]TRANSIT-SG`[]TRANSIT-JP`[]TRANSIT-US`[]TRANSIT-UK`[]BWG`[]AUTO`[]SELECT
custom_proxy_group=Bilibili`select`[]DIRECT`[]RELAY-CHAIN`[]HK`[]TW`[]SG`[]JP`[]US`[]UK`[]TRANSIT-HK`[]TRANSIT-TW`[]TRANSIT-SG`[]TRANSIT-JP`[]TRANSIT-US`[]TRANSIT-UK`[]BWG`[]AUTO`[]SELECT
custom_proxy_group=Streaming media`select`[]SELECT`[]HK Fallback`[]HK`[]TW`[]SG`[]JP`[]US`[]UK`[]TRANSIT-HK`[]TRANSIT-TW`[]TRANSIT-SG`[]TRANSIT-JP`[]TRANSIT-US`[]TRANSIT-UK`[]BWG`[]AUTO`[]RELAY-CHAIN`[]DIRECT
custom_proxy_group=Cryptocurrency`select`[]SELECT`[]HK Fallback`[]HK`[]TW`[]SG`[]JP`[]US`[]UK`[]TRANSIT-HK`[]TRANSIT-TW`[]TRANSIT-SG`[]TRANSIT-JP`[]TRANSIT-US`[]TRANSIT-UK`[]BWG`[]AUTO`[]RELAY-CHAIN`[]DIRECT
custom_proxy_group=PayPal`select`[]SELECT`[]US Fallback`[]US`[]JP`[]SG`[]TW`[]HK`[]UK`[]TRANSIT-HK`[]TRANSIT-TW`[]TRANSIT-SG`[]TRANSIT-JP`[]TRANSIT-US`[]TRANSIT-UK`[]BWG`[]AUTO`[]RELAY-CHAIN`[]DIRECT
custom_proxy_group=Stripe`select`[]SELECT`[]US Fallback`[]US`[]JP`[]SG`[]TW`[]HK`[]UK`[]TRANSIT-HK`[]TRANSIT-TW`[]TRANSIT-SG`[]TRANSIT-JP`[]TRANSIT-US`[]TRANSIT-UK`[]BWG`[]AUTO`[]RELAY-CHAIN`[]DIRECT
custom_proxy_group=AI`select`[]SELECT`[]US Fallback`[]US`[]JP`[]SG`[]TW`[]HK`[]UK`[]TRANSIT-HK`[]TRANSIT-TW`[]TRANSIT-SG`[]TRANSIT-JP`[]TRANSIT-US`[]TRANSIT-UK`[]BWG`[]AUTO`[]RELAY-CHAIN`[]DIRECT
custom_proxy_group=Claude`select`[]SELECT`[]HK Fallback`[]HK`[]TW`[]SG`[]JP`[]US`[]UK`[]TRANSIT-HK`[]TRANSIT-TW`[]TRANSIT-SG`[]TRANSIT-JP`[]TRANSIT-US`[]TRANSIT-UK`[]BWG`[]AUTO`[]RELAY-CHAIN`[]DIRECT
custom_proxy_group=Gemini`select`[]SELECT`[]HK Fallback`[]HK`[]TW`[]SG`[]JP`[]US`[]UK`[]TRANSIT-HK`[]TRANSIT-TW`[]TRANSIT-SG`[]TRANSIT-JP`[]TRANSIT-US`[]TRANSIT-UK`[]BWG`[]AUTO`[]RELAY-CHAIN`[]DIRECT
custom_proxy_group=Grok`select`[]SELECT`[]HK Fallback`[]HK`[]TW`[]SG`[]JP`[]US`[]UK`[]TRANSIT-HK`[]TRANSIT-TW`[]TRANSIT-SG`[]TRANSIT-JP`[]TRANSIT-US`[]TRANSIT-UK`[]BWG`[]AUTO`[]RELAY-CHAIN`[]DIRECT
custom_proxy_group=Perplexity`select`[]SELECT`[]HK Fallback`[]HK`[]TW`[]SG`[]JP`[]US`[]UK`[]TRANSIT-HK`[]TRANSIT-TW`[]TRANSIT-SG`[]TRANSIT-JP`[]TRANSIT-US`[]TRANSIT-UK`[]BWG`[]AUTO`[]RELAY-CHAIN`[]DIRECT
custom_proxy_group=Games CN`select`[]DIRECT`[]RELAY-CHAIN`[]HK`[]TW`[]SG`[]JP`[]US`[]UK`[]TRANSIT-HK`[]TRANSIT-TW`[]TRANSIT-SG`[]TRANSIT-JP`[]TRANSIT-US`[]TRANSIT-UK`[]BWG`[]AUTO`[]SELECT
custom_proxy_group=Games`select`[]SELECT`[]HK Fallback`[]HK`[]TW`[]SG`[]JP`[]US`[]UK`[]TRANSIT-HK`[]TRANSIT-TW`[]TRANSIT-SG`[]TRANSIT-JP`[]TRANSIT-US`[]TRANSIT-UK`[]BWG`[]AUTO`[]RELAY-CHAIN`[]DIRECT
custom_proxy_group=Google FCM`select`[]DIRECT`[]RELAY-CHAIN`[]HK`[]TW`[]SG`[]JP`[]US`[]UK`[]TRANSIT-HK`[]TRANSIT-TW`[]TRANSIT-SG`[]TRANSIT-JP`[]TRANSIT-US`[]TRANSIT-UK`[]BWG`[]AUTO`[]SELECT
custom_proxy_group=OneDrive`select`[]SELECT`[]HK Fallback`[]HK`[]TW`[]SG`[]JP`[]US`[]UK`[]TRANSIT-HK`[]TRANSIT-TW`[]TRANSIT-SG`[]TRANSIT-JP`[]TRANSIT-US`[]TRANSIT-UK`[]BWG`[]AUTO`[]RELAY-CHAIN`[]DIRECT
custom_proxy_group=Microsoft CN`select`[]DIRECT`[]RELAY-CHAIN`[]HK`[]TW`[]SG`[]JP`[]US`[]UK`[]TRANSIT-HK`[]TRANSIT-TW`[]TRANSIT-SG`[]TRANSIT-JP`[]TRANSIT-US`[]TRANSIT-UK`[]BWG`[]AUTO`[]SELECT
custom_proxy_group=Microsoft`select`[]SELECT`[]HK Fallback`[]HK`[]TW`[]SG`[]JP`[]US`[]UK`[]TRANSIT-HK`[]TRANSIT-TW`[]TRANSIT-SG`[]TRANSIT-JP`[]TRANSIT-US`[]TRANSIT-UK`[]BWG`[]AUTO`[]RELAY-CHAIN`[]DIRECT
custom_proxy_group=iCloud CN`select`[]DIRECT`[]RELAY-CHAIN`[]HK`[]TW`[]SG`[]JP`[]US`[]UK`[]TRANSIT-HK`[]TRANSIT-TW`[]TRANSIT-SG`[]TRANSIT-JP`[]TRANSIT-US`[]TRANSIT-UK`[]BWG`[]AUTO`[]SELECT
custom_proxy_group=iCloud`select`[]SELECT`[]HK Fallback`[]HK`[]TW`[]SG`[]JP`[]US`[]UK`[]TRANSIT-HK`[]TRANSIT-TW`[]TRANSIT-SG`[]TRANSIT-JP`[]TRANSIT-US`[]TRANSIT-UK`[]BWG`[]AUTO`[]RELAY-CHAIN`[]DIRECT
custom_proxy_group=Apple CN`select`[]DIRECT`[]RELAY-CHAIN`[]HK`[]TW`[]SG`[]JP`[]US`[]UK`[]TRANSIT-HK`[]TRANSIT-TW`[]TRANSIT-SG`[]TRANSIT-JP`[]TRANSIT-US`[]TRANSIT-UK`[]BWG`[]AUTO`[]SELECT
custom_proxy_group=Apple`select`[]SELECT`[]HK Fallback`[]HK`[]TW`[]SG`[]JP`[]US`[]UK`[]TRANSIT-HK`[]TRANSIT-TW`[]TRANSIT-SG`[]TRANSIT-JP`[]TRANSIT-US`[]TRANSIT-UK`[]BWG`[]AUTO`[]RELAY-CHAIN`[]DIRECT
custom_proxy_group=Social Media CN`select`[]DIRECT`[]RELAY-CHAIN`[]HK`[]TW`[]SG`[]JP`[]US`[]UK`[]TRANSIT-HK`[]TRANSIT-TW`[]TRANSIT-SG`[]TRANSIT-JP`[]TRANSIT-US`[]TRANSIT-UK`[]BWG`[]AUTO`[]SELECT
custom_proxy_group=Social Media`select`[]SELECT`[]HK Fallback`[]HK`[]TW`[]SG`[]JP`[]US`[]UK`[]TRANSIT-HK`[]TRANSIT-TW`[]TRANSIT-SG`[]TRANSIT-JP`[]TRANSIT-US`[]TRANSIT-UK`[]BWG`[]AUTO`[]RELAY-CHAIN`[]DIRECT
custom_proxy_group=Media CN`select`[]DIRECT`[]RELAY-CHAIN`[]HK`[]TW`[]SG`[]JP`[]US`[]UK`[]TRANSIT-HK`[]TRANSIT-TW`[]TRANSIT-SG`[]TRANSIT-JP`[]TRANSIT-US`[]TRANSIT-UK`[]BWG`[]AUTO`[]SELECT
custom_proxy_group=Media`select`[]SELECT`[]HK Fallback`[]HK`[]TW`[]SG`[]JP`[]US`[]UK`[]TRANSIT-HK`[]TRANSIT-TW`[]TRANSIT-SG`[]TRANSIT-JP`[]TRANSIT-US`[]TRANSIT-UK`[]BWG`[]AUTO`[]RELAY-CHAIN`[]DIRECT
custom_proxy_group=Scholar CN`select`[]DIRECT`[]RELAY-CHAIN`[]HK`[]TW`[]SG`[]JP`[]US`[]UK`[]TRANSIT-HK`[]TRANSIT-TW`[]TRANSIT-SG`[]TRANSIT-JP`[]TRANSIT-US`[]TRANSIT-UK`[]BWG`[]AUTO`[]SELECT
custom_proxy_group=Scholar`select`[]SELECT`[]HK Fallback`[]HK`[]TW`[]SG`[]JP`[]US`[]UK`[]TRANSIT-HK`[]TRANSIT-TW`[]TRANSIT-SG`[]TRANSIT-JP`[]TRANSIT-US`[]TRANSIT-UK`[]BWG`[]AUTO`[]RELAY-CHAIN`[]DIRECT
custom_proxy_group=Personal`select`[]SELECT`[]HK Fallback`[]HK`[]TW`[]SG`[]JP`[]US`[]UK`[]TRANSIT-HK`[]TRANSIT-TW`[]TRANSIT-SG`[]TRANSIT-JP`[]TRANSIT-US`[]TRANSIT-UK`[]BWG`[]AUTO`[]RELAY-CHAIN`[]DIRECT
custom_proxy_group=Global Direct`select`[]DIRECT`[]RELAY-CHAIN`[]HK`[]TW`[]SG`[]JP`[]US`[]UK`[]TRANSIT-HK`[]TRANSIT-TW`[]TRANSIT-SG`[]TRANSIT-JP`[]TRANSIT-US`[]TRANSIT-UK`[]BWG`[]AUTO`[]SELECT
custom_proxy_group=CN Direct`select`[]DIRECT`[]RELAY-CHAIN`[]HK`[]TW`[]SG`[]JP`[]US`[]UK`[]TRANSIT-HK`[]TRANSIT-TW`[]TRANSIT-SG`[]TRANSIT-JP`[]TRANSIT-US`[]TRANSIT-UK`[]BWG`[]AUTO`[]SELECT
custom_proxy_group=Final`select`[]SELECT`[]HK Fallback`[]HK`[]TW`[]SG`[]JP`[]US`[]UK`[]TRANSIT-HK`[]TRANSIT-TW`[]TRANSIT-SG`[]TRANSIT-JP`[]TRANSIT-US`[]TRANSIT-UK`[]BWG`[]AUTO`[]RELAY-CHAIN`[]DIRECT
